!function(n,e,o,i){"use strict";var t=1,a=2,c=t,l=!0,s=0,d=0,f=null,r=0,u=[],h=null,p=null,v=null,w=null,m=null,b=null,g=null,y=null,x=null,C=function(n){n.stopPropagation(),n.preventDefault(),n.dataTransfer.dropEffect="copy"},k=function(n){n.stopPropagation(),n.preventDefault();for(var e=n.dataTransfer.files,o=e.length,i=null,t=[];o--;)i=e[o],i.type.toLowerCase().indexOf("image/")<0||t.push(i);t.sort(function(n,e){return n.name<e.name?-1:n.name>e.name?1:0}),0!==t.length&&(u=u.concat(t),D(u.length),r=d,P())},D=function(n){m.find(".hd .count").text("("+n+")")},P=function(){var e,o=d,i=u[o],t=new FileReader;d++,e='<li><a href="#" data-index="'+o+'">'+i.name+"</a></li>",y.find(".filenames").append(e),t.onload=function(e){return function(i){var t=n('<div class="view" data-index="'+o+'"></div>'),c=n("<img />");p.append(t),c.on("load",function(i){var t=this.width,a=this.height;T(this,e.name,o,t,a),n(this).css({"margin-left":"-"+Math.round(t/2)+"px"})}),t.append(c),c.attr("src",i.target.result),l&&(l=!1,Y(a)),o===r&&z(o),d<u.length&&P()}}(i),t.readAsDataURL(i)},T=function(e,o,i,t,a){var c,l,s,d,f=n('<canvas width="100" height="100" class="thumb" title="'+o+'" data-index="'+i+'"></canvas>');t>a?(c=100,l=a/t*c,s=0,d=(100-l)/2):(l=100,c=t/a*l,s=(100-c)/2,d=0);var r=f.get(0).getContext("2d");r.drawImage(e,s,d,c,l),x.append(f)},F=function(){n(o.body).on("click",function(n){E()})},L=function(){n(o.body).off("click")},q=function(){return p.find(".view").each(function(e,o){n(o).is(":visible")&&(s=e)}),s},E=function(){var n=q()+1;n>p.children().length-1&&(n=0),z(n)},R=function(){var n=q()-1;0>n&&(n=p.children().length-1),z(n)},z=function(o){p.children().hide(),p.children().eq(o).show(),y.find("ul").children().removeClass("selected"),y.find("ul").children().eq(o).addClass("selected"),x.children().removeClass("selected"),x.children().eq(o).addClass("selected"),n(e).scrollTop(0)},O=function(){m.hasClass("is-open")?K():A()},j=function(){b.hasClass("is-open")?K():G()},A=function(){I(m)},G=function(){I(b)},I=function(e){K(),N(),f=e,f.addClass("is-open"),c===a&&(n(o.body).css("overflow","hidden"),L(),$())},K=function(){null!==f&&(V(),f.removeClass("is-open"),f=null,c===a&&(n(o.body).css("overflow","auto"),F(),Z()))},M=function(){l=!0,s=0,d=0,u=[],Y(t)},Q=function(){y.show(),x.hide()},S=function(){y.hide(),x.show()},U=function(){w.show()},B=function(){w.hide()},H=function(){p.show()},J=function(){p.hide()},N=function(){g.show()},V=function(){g.hide()},W=function(){n(".btn-index").show(),n(".btn-next").show(),n(".btn-prev").show()},X=function(){n(".btn-index").hide(),n(".btn-next").hide(),n(".btn-prev").hide()},Y=function(n){if(n!==c)switch(c=n){case t:V(),J(),K(),U(),X(),an(),L(),$(),D(0),y.find(".filenames").empty(),x.empty(),p.empty();break;case a:B(),K(),H(),W(),an(),F(),Z()}},Z=function(){n(o.body).on("mousemove",nn),n(o.body).on("mousedown",nn),n(o.body).on("mouseleave",_),en()},$=function(){n(o.body).off("mousemove",nn),n(o.body).off("mousedown",nn),n(o.body).off("mouseleave",_),on()},_=function(){tn()},nn=function(){v.is(":visible")||(v.stop(),an()),en()},en=function(){on(),h=setTimeout(tn,3e3)},on=function(){null!==h&&(clearTimeout(h),h=null)},tn=function(){on(),v.fadeOut(500)},an=function(){v.show()};n(o).ready(function(){return w=n(".drop-zone"),v=n(".nav"),p=n(".views"),m=n(".index"),b=n(".help"),g=n(".blocker"),y=m.find(".list"),x=m.find(".thumbs"),X(),v.find(".btn-help").on("click",function(n){n.preventDefault(),n.stopPropagation(),G()}),g.on("mousedown",function(n){K()}),e.File&&e.FileReader&&e.FileList?(o.body.addEventListener("dragover",C,!1),o.body.addEventListener("drop",k,!1),m.on("click","a, canvas",function(e){e.preventDefault(),e.stopPropagation(),z(n(this).data("index")),K()}),v.find(".btn-next").on("click",function(n){n.preventDefault(),n.stopPropagation(),E()}),v.find(".btn-prev").on("click",function(n){n.preventDefault(),n.stopPropagation(),R()}),v.find(".btn-index").on("click",function(n){n.preventDefault(),n.stopPropagation(),A()}),m.find(".btn-list").on("click",function(n){n.preventDefault(),n.stopPropagation(),Q()}),m.find(".btn-thumbs").on("click",function(n){n.preventDefault(),n.stopPropagation(),S()}),void n(o).on("keydown",function(n){var e=p.children().length;if(n.shiftKey&&191===n.which)return void j();if(13===n.which)return void(m.hasClass("is-open")&&K());if(27===n.which)return void(f&&(n.preventDefault(),n.stopPropagation(),K()));if(!(1>e)){if(73===n.which)return void O();if(82===n.which)return void M();if(84===n.which)return void(m.hasClass("is-open")&&(x.is(":visible")?Q():S()));if(!(2>e))return 74===n.which||37===n.which?void R():75===n.which||39===n.which?void E():void 0}})):(v.addClass("fallback"),w.find(".msg").text("Sorry, your browser does not support local file access"),void w.find(".sub").html('Try <a href="http://www.google.com/chrome">Google Chrome</a> or <a href="http://www.mozilla.org/firefox">Firefox</a>'))})}(jQuery,window,document);